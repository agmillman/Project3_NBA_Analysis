CREATE VIEW public."made_shots_view" AS
SELECT
	p."SEASON_ID",
	p."PLAYER_NAME",
	s."SHOT_ZONE_BASIC",
	SUM(s."SHOT_MADE_FLAG") AS "TOT_MAKES"
FROM public."PlayerCareer_Stats" p
INNER JOIN (SELECT *,
    CASE
        WHEN CAST("GAME_DATE" AS DATE) BETWEEN '2013-10-01' AND '2014-06-30' THEN '2013-14'
        WHEN CAST("GAME_DATE" AS DATE) BETWEEN '2014-10-01' AND '2015-06-30' THEN '2014-15'
		WHEN CAST("GAME_DATE" AS DATE) BETWEEN '2015-10-01' AND '2016-06-30' THEN '2015-16'
		WHEN CAST("GAME_DATE" AS DATE) BETWEEN '2016-10-01' AND '2017-06-30' THEN '2016-17'
		WHEN CAST("GAME_DATE" AS DATE) BETWEEN '2017-10-01' AND '2018-06-30' THEN '2017-18'
		WHEN CAST("GAME_DATE" AS DATE) BETWEEN '2018-10-01' AND '2019-06-30' THEN '2018-19'
		WHEN CAST("GAME_DATE" AS DATE) BETWEEN '2019-10-01' AND '2020-06-30' THEN '2019-20'
		WHEN CAST("GAME_DATE" AS DATE) BETWEEN '2020-10-01' AND '2021-06-30' THEN '2020-21'
		WHEN CAST("GAME_DATE" AS DATE) BETWEEN '2021-10-01' AND '2022-06-30' THEN '2021-22'
		WHEN CAST("GAME_DATE" AS DATE) BETWEEN '2022-10-01' AND '2023-06-30' THEN '2022-23'
    END --AS "SEASON_ID"
FROM public."ShotChartDetail"
) s on s."PLAYER_ID" = p."PLAYER_ID" AND s."case" = p."SEASON_ID"
GROUP BY p."SEASON_ID", p."PLAYER_NAME",
	s."SHOT_ZONE_BASIC"